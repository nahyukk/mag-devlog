---
title: "DB Check ì œì•½ì¡°ê±´ ì˜¤ë¥˜ í•´ê²°ê¸°"
description: "Check constraint 'user_chk_1' ì˜¤ë¥˜ë¥¼ ë¶„ì„í•˜ê³ , enum íƒ€ì… ì „í™˜ ì´í›„ ë°œìƒí•œ MySQL ì œì•½ ì¡°ê±´ ì´ìŠˆë¥¼ í•´ê²°í•œ ê³¼ì •"
date: "2025.05.21"
filter: ["MySQL", "DB"]
---

ê°‘ìê¸° ë‚ ì•„ì˜¨ ë””ì— ...

<br />
<img src="https://lh3.googleusercontent.com/d/1Pb02OLukughBntsLY4GSAugeYY4w2bVk" width="50%" />

- ì´ë¯¸ ëª‡ì¼ ì „ ë¡œì»¬ì—ì„œ ë´¤ë˜ê±°ë¼ ì–´ë–»ê²Œë“  í•´ê²°í•  ìˆ˜ ìˆë‹¤ëŠ” ìì‹ ê°ì˜ ë‹µì¥ â€œë„µë„µ~â€

---

#### ë¬¸ì œ ìƒí™©

- ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ í•˜ëŠ”ë° ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ëœ¸.
<br />

```json
{
"code": "DB_ACCESS_ERROR",
"message": "ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ ë°œìƒ: could not execute statement [Check constraint 'user_chk_1' is violated.] [/* insert for com.even.zaro.entity.User */insert into user (birth_date, created_at, email, follower_count, following_count, gender, last_login_at, live_alone_date, mbti, nickname, password, profile_image, provider,provider_id, status, updated_at) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)]",
"data": null
}
```

- ì˜ëª»ëœ ì œì•½ ì¡°ê±´ì´ ë“¤ì–´ê°€ ìˆëŠ” ê²ƒ.
- providerê°€ 0, 1ë¡œ ë˜ì–´ìˆëŠ” ê±¸ enum(string)ìœ¼ë¡œ ìˆ˜ì •í•œ ì ì´ ìˆëŠ”ë° ì´ ì´í›„ë¡œ ì´ ì—ëŸ¬ê°€ ë‚˜íƒ€ë‚¨.
- ì²˜ìŒì— ë¡œì»¬ dbì—ì„œ ë‚˜íƒ€ë‚˜ì„œ ì œì•½ì¡°ê±´ì„ ì—†ì•  ë²„ë ¸ìŒ.
- ì„œë²„ì—ì„œ ê°™ì€ ì—ëŸ¬ê°€ ë‚œë‹¤ëŠ” ì œë³´ë¥¼ ë°›ê³  í™•ì¸ í•´ë´„. ì„œë²„ë¼ ì œì•½ ì¡°ê±´ì„ ì—†ì• ëŠ” ê±´ ì•„ë‹Œ ê²ƒ ê°™ì•„ì„œ ìˆ˜ì •í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ í•´ê²°í•¨.

<aside>
  ğŸ‘¾ ì´ì „ê¹Œì§€ ì›Œí¬ë²¤ì¹˜ì—ì„œ ì¿¼ë¦¬ ëŒë¦¬ëŠ” ê±° ëª»í•˜ê³  uië¡œë§Œ ì–´ë–»ê²Œ ì–´ë–»ê²Œ í–ˆëŠ”ë° ì¿¼ë¦¬ ë¬¸ ë‚ ë¦¬ëŠ” ê±°.. ìƒê°ë³´ë‹¤ í¸í•˜ê³  ì¢‹ë‹¤.

  <img src="https://lh3.googleusercontent.com/d/1Ei_5dUeDm6m1pS_nh4aFygtsN8dCR9Uo" width="80%" />

  - ì¿¼ë¦¬ ì‘ì„±í•˜ê³  ë²ˆê°œ ëª¨ì–‘ ëˆ„ë¥´ë©´ ì‹¤í–‰ë˜ë©´ì„œ ì•„ë˜ outputìœ¼ë¡œ ë‚˜ì˜´.
</aside>

---

#### í•´ê²°

- ìš°ì„  ì–´ë–¤ ì œì•½ ì¡°ê±´ì´ ìˆëŠ”ì§€ í™•ì¸

```sql
USE evendb;

SHOW CREATE TABLE user;
```
<br />
- ì•„ë˜ëŠ” output

```sql
CREATE TABLE user (
  id bigint NOT NULL AUTO_INCREMENT,
  birth_date date DEFAULT NULL,
  created_at datetime(6) NOT NULL,
  email varchar(255) NOT NULL,
  follower_count int DEFAULT NULL,
  following_count int DEFAULT NULL,
  gender varchar(255) DEFAULT NULL,
  last_login_at datetime(6) DEFAULT NULL,
  live_alone_date date DEFAULT NULL,
  mbti varchar(4) DEFAULT NULL,
  nickname varchar(255) NOT NULL,
  password varchar(255) DEFAULT NULL,
  profile_image varchar(255) DEFAULT NULL,
  status enum('ACTIVE','DELETED','DORMANT','PENDING') NOT NULL,
  updated_at datetime(6) DEFAULT NULL,
  provider enum('LOCAL','KAKAO') NOT NULL,
  provider_id varchar(255) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY UKob8kqyqqgmefl0aco34akdtpe (email),
  UNIQUE KEY UKavppunt4c0qpxo9giv18an98o (provider,provider_id),
  **CONSTRAINT user_chk_1 CHECK ((provider between 0 and 1)**)
) ENGINE=InnoDB AUTO_INCREMENT=19 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
```

- **`CONSTRAINT user_chk_1 CHECK ((provider between 0 and 1))` ì´ ë¶€ë¶„ì´ ë¬¸ì œ**

<br />
<ThinShortLine />
<br />

```sql
ALTER TABLE user
DROP CHECK user_chk_1;

ALTER TABLE user
ADD CONSTRAINT user_chk_1 CHECK (provider IN ('LOCAL', 'KAKAO'));
```

- ê¸°ì¡´ ì œì•½ ì¡°ê±´ì„ ì—†ì• ê³ , ìˆ˜ì •ëœ ì œì•½ ì¡°ê±´ì„ ë„£ìŒ.
  - ê¸°ì¡´ `0`, `1` â†’ `LOCAL`, `KAKAO`ë¡œ ìˆ˜ì •

---

#### ë°°ìš´ ì 

ì´ì œ ì œì•½ ì¡°ê±´ ë”°ìœ„ ë‘ë µì§€ ì•Šë‹¤.

<aside>
  ğŸ’ğŸ»â€â™€ï¸ **ì™œ DBì— ì œì•½ì¡°ê±´ì„ ê±°ëŠ”ê°€?**
  - ë°ì´í„°ì˜ ì •í•©ì„±ê³¼ ì‹ ë¢°ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ í•„ìš”
    - ì‹¤ìˆ˜ ë°©ì§€(CHECK), ì¤‘ë³µ ë°©ì§€(UNIQUE), í•„ìˆ˜ ê°’ ë³´ì¥(NOT NULL)
    - ê´€ê³„ ë³´ì¥(FK)
    - ì‚­ì œ ìˆ˜ì • ì—°ì‡„ë°©ì§€ (ON DELETE CASCADE ì„¤ì •) 
</aside>